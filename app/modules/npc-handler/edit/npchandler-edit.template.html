<div>
<button  ng-click='$ctrl.save()'>Save</button>
    <fieldset>
        <legend>{{$ctrl.npcData.name}}</legend>

        <div>
            <fieldset style="background-color:#ffddb0; width:20%; float:left">
                <legend>General</legend>
                UID: <input type="text" name="id" readonly ng-model="$ctrl.npcData.uid"><br />
                Name: <input ng-model='$ctrl.npcData.name'><br />
                Map: <input ng-model='$ctrl.npcData.mapName'><br />
                Behavior Id: <input type="number" ng-model='$ctrl.npcData.behaviorId'><br />
                Is Facing Right: <input type="checkbox" ng-model='$ctrl.npcData.facingRight'>
            </fieldset>
            <sprite data='$ctrl.npcData.spriteData'></sprite>
        </div>
    </fieldset>

    <fieldset>
        <legend>Interactions</legend>

            Interaction Order:
            <span ng-repeat="order in $ctrl.npcData.interactionOrder track by $index">
                <input type="number" id="tinynumberInput" ng-model='$ctrl.npcData.interactionOrder[$index]'>
            </span>


        <ul>
<!--        <li ng-repeat="inter in $ctrl.npcData.interactionData">-->
            <li ng-repeat="inter in $ctrl.getSortedInteractionData() track by $index">
            <fieldset style="background-color:#bde7a5">
                <legend>{{inter.type}}</legend>

                <div style="padding-top:10px; padding-bottom: 5px">
                    <button ng-click='$ctrl.removeInteraction(inter)' style="float:right">Remove Interaction</button>
                </div>

                Id: <input type="number" readonly ng-model="inter.id">
                <br />
                Type: <select ng-model='inter.type'>
                    <option value="DIALOG">Dialog</option>
                    <option value="MERCHANT">Merchant</option>
                    <option value="GIVE_ITEM">Give Item</option>
                    <option value="PLAY_SOUND">Play Sound</option>
                    <option value="TELEPORT">Teleport</option>
                    <option value="REMOVE_QUEST_ITEM">Remove Quest Item</option>
                </select>
                <br />

                <span style="float:left">Required Events State:</span>
                <br />
                <ul style="background:#b8daff;">
                    <li ng-repeat="reqState in inter.requireEventsState" style="padding-top:10px; padding-bottom: 10px">
                        <select name="Type: " ng-model='reqState.type'>
                            <option value="SWITCH">Switch</option>
                            <option value="QUEST_ITEM">Quest Item</option>
                            <option value="NO_ENEMIES_IN_AREA">No Enemies in Area</option>
                        </select>
                        <span ng-hide='reqState.type !== "SWITCH"'>
                            Key:<input type="text" ng-model='reqState.key' style="width: 350px">
                            State: <input type="checkbox" ng-model='reqState.value'>
                        </span>
                        <span ng-hide='reqState.type !== "NO_ENEMIES_IN_AREA"'>
                            TargetX: <input type="number" ng-model='reqState.targetX' style="width: 60px">
                            TargetY: <input type="number" ng-model='reqState.targetY' style="width: 60px">
                        </span>
                        <span ng-hide='reqState.type !== "QUEST_ITEM"'>
                            TargetEntity:<input type="text" ng-model='reqState.targetEntity' style="width: 350px">
                        </span>
                        <button  ng-click='$ctrl.removeElementFromArray(inter.requireEventsState, reqState)' style="margin-left: 100px">Remove</button>
                    </li>
                    <div style="padding-top:10px; padding-bottom: 5px"><button  ng-click='$ctrl.addEventState(inter.requireEventsState)'>Add Event</button></div>
                </ul>

                <!-- TODO: find a way to reuse the code for events. -->
                <span style="float:left">Update Events State:</span>
                <br />
                <ul style="background:#66b0ff;">
                    <li ng-repeat="updState in inter.updateEventsState" style="padding-top:10px; padding-bottom: 10px">
                        <select name="Type: " ng-model='updState.type'>
                            <option value="SWITCH">Switch</option>
                            <option value="QUEST_ITEM">Quest Item</option>
                            <option value="NO_ENEMIES_IN_AREA">No Enemies in Area</option>
                        </select>
                        <span ng-hide='updState.type !== "SWITCH"'>
                            Key:<input type="text" ng-model='updState.key' style="width: 350px">
                            State: <input type="checkbox" ng-model='updState.value'>
                        </span>
                        <span ng-hide='updState.type !== "NO_ENEMIES_IN_AREA"'>
                            TargetX: <input type="number" ng-model='updState.targetX' style="width: 60px">
                            TargetY: <input type="number" ng-model='updState.targetY' style="width: 60px">
                        </span>
                        <span ng-hide='updState.type !== "QUEST_ITEM"'>
                            TargetEntity:<input type="text" ng-model='updState.targetEntity' style="width: 350px">
                        </span>
                        <button  ng-click='$ctrl.removeElementFromArray(inter.updateEventsState, updState)' style="margin-left: 100px">Remove</button>
                    </li>
                    <div style="padding-top:10px; padding-bottom: 5px"><button  ng-click='$ctrl.addEventState(inter.updateEventsState)'>Add Event</button></div>
                </ul>

                <span ng-hide='inter.type !== "MERCHANT" && inter.type !== "GIVE_ITEM"'>
                    Price Multiplier: <input type="number" step="0.01" id="numberInput" ng-model='inter.priceMultiplier'><br />
                    <ul style="background:#b8daff;">
                        Items:
                        <br />
                        <li ng-repeat="itemName in inter.items track by $index" style="padding-top:5px; padding-bottom: 5px">
                            <input type="text" ng-model='inter.items[$index]'>
                            <button  ng-click='$ctrl.removeElementFromArray(inter.items, inter.items[$index])' style="margin-left: 100px">Remove</button>
                        </li>
                        <div style="padding-top:10px; padding-bottom: 5px"><button  ng-click='$ctrl.addElementToArray(inter.items, "FIX ME")'>Add Item</button></div>
                    </ul>
                </span>


                <span ng-hide='inter.type !== "TELEPORT"'>
                    Teleport Target Id: <input type="number" step="1" id="numberInput" ng-model='inter.targetId'>
                    Pos - X: <input type="number" step="1" id="numberInput" ng-model='inter.toPos.x'>
                    Y: <input type="number" step="1" id="numberInput" ng-model='inter.toPos.y'><br />
                </span>

                <span ng-hide='inter.type !== "REMOVE_QUEST_ITEM" && inter.type !== "PLAY_SOUND"'>
                    Target Data: <input type="text" ng-model='inter.targetData' style="width: 350px">
                </span>
                <br />

                <span ng-hide='inter.type !== "DIALOG"'>
                    <ul style="background:#b8daff;">
                        <li ng-repeat="msg in inter.messages" style="padding-top:5px; padding-bottom: 5px">
                        <fieldset style="background-color:#afbf7f">
                            <legend>Message {{msg.id}}</legend>
                            <div style="float:left; width:73%">
                                <legend>Title</legend>
                                <div style="background-color:#5cb1af">
                                    <div style="float:left;"><textarea rows="4" cols="100" ng-model='msg.title.text'></textarea></div>
                                    <div>
                                        Font: <input type="text" ng-model='msg.title.font'>
                                        Style: <input type="number" id="numberInput" ng-model='msg.title.style'>
                                        Size: <input type="number" id="numberInput" ng-model='msg.title.size'>
                                        Color: Text: <input type="color" ng-model='msg.title.colorAsHex'><br />
                                        Horizontal Align: <input type="number" id="numberInput" ng-model='msg.title.horizontalAlignment'>
                                        Vertical Align: <input type="number" id="numberInput" ng-model='msg.title.verticalAlignment'>
                                        <br />
                                        <span>
                                            Rect
                                            X: <input type="number" id="numberInput" ng-model='msg.title.rect.x'>
                                            Y: <input type="number" id="numberInput" ng-model='msg.title.rect.y'>
                                            W: <input type="number" id="numberInput" ng-model='msg.title.rect.width'>
                                            H: <input type="number" id="numberInput" ng-model='msg.title.rect.height'>
                                        </span>
                                    </div>
                                </div>
                                <legend>Text</legend>
                                <div style="background-color:#5cb1af">
                                    <div style="float:left;"><textarea rows="4" cols="100" ng-model='msg.text.text'></textarea></div>
                                    <div>
                                        Font: <input type="text" ng-model='msg.text.font'>
                                        Style: <input type="number" id="numberInput" ng-model='msg.text.style'>
                                        Size: <input type="number" id="numberInput" ng-model='msg.text.size'>
                                        Color: Text: <input type="color" ng-model='msg.text.colorAsHex'><br />
                                        Horizontal Align: <input type="number" id="numberInput" ng-model='msg.text.horizontalAlignment'>
                                        Vertical Align: <input type="number" id="numberInput" ng-model='msg.text.verticalAlignment'>
                                        <br />
                                        <span>
                                            Rect
                                            X: <input type="number" id="numberInput" ng-model='msg.text.rect.x'>
                                            Y: <input type="number" id="numberInput" ng-model='msg.text.rect.y'>
                                            W: <input type="number" id="numberInput" ng-model='msg.text.rect.width'>
                                            H: <input type="number" id="numberInput" ng-model='msg.text.rect.height'>
                                        </span>
                                    </div>
                                </div>
                            </div>
                            <div style="padding-top:10px; padding-bottom: 5px">
                                <button ng-click='$ctrl.removeElementFromArray(inter.messages, msg)'>Remove Message</button>
                            </div>
                        </fieldset>
                        </li>
                    </ul>
                    <div style="padding-top:10px; padding-bottom: 5px">
                        <button  ng-click='$ctrl.addMessage(inter.messages)'>Add Message</button>
                    </div>
                </span>
            </fieldset>
        </li>
        </ul>
        <div style="padding-top:10px; padding-bottom: 5px">
            <button ng-click='$ctrl.addInteraction()'>Add Interaction</button>
        </div>
    </fieldset>

</div>
